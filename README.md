## Полезные команды

### START ALL CONTAINERS:
```
./start-dev-all.sh
or
./start-prod-all.sh
```

### STOP ALL CONTAINERS:
```
./stop-dev-all.sh
or
./stop-prod-all.sh
```
### Применить изменения в nginx.conf:
`docker compose -f docker-compose.dev.yaml exec nginx sh`
`nginx -s reload`

### Prisma
`yarn prisma migrate dev --name init`
`yarn prisma:seed`
`yarn prisma:seed-undo`
`yarn prisma db push`
`yarn prisma generate`


## Redis:

При работе с WebSocket важен постоянный двунаправленный канал между сервером и клиентом. При горизонтальном масштабировании (несколько экземпляров сервера, запущенных за балансировщиком нагрузки) клиент может подключиться к любому серверу. Когда нужно отправить сообщение клиенту, сервер должен доставить это сообщение вне зависимости от того, к какому именно из экземпляров клиент подключен.

Если серверы не связаны между собой, то пользователь, подключенный к серверу А, не получит сообщения, отправленные сервером Б. Решается это через общую систему обмена сообщениями (очередь, шина Pub/Sub).

Redis выступает как центральный Pub/Sub-брокер:

Каждый экземпляр сервера WebSocket подписывается на канал Redis для получения сообщений, предназначенных его подключенным клиентам.

Когда сервер А хочет отправить сообщение клиенту, который подключен к серверу Б, это сообщение публикуется в канал Redis.

Сервер Б получает это сообщение из Redis через подписку и пересылает клиенту по WebSocket.

Таким образом достигается синхронизация сообщений между всеми инстансами серверов.

Клиенты подключаются к балансировщику нагрузки (nginx с sticky session), а backend работает с Redis для обмена сообщениями между инстансами.

